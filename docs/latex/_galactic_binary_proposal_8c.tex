\hypertarget{_galactic_binary_proposal_8c}{}\doxysection{gbmcmc/src/\+Galactic\+Binary\+Proposal.c File Reference}
\label{_galactic_binary_proposal_8c}\index{gbmcmc/src/GalacticBinaryProposal.c@{gbmcmc/src/GalacticBinaryProposal.c}}
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+blas.\+h$>$}\newline
{\ttfamily \#include $<$sys/stat.\+h$>$}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+rng.\+h$>$}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+sort.\+h$>$}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+randist.\+h$>$}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+matrix.\+h$>$}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+linalg.\+h$>$}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+vector.\+h$>$}\newline
{\ttfamily \#include $<$gsl/gsl\+\_\+eigen.\+h$>$}\newline
{\ttfamily \#include \char`\"{}L\+I\+S\+A.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Constants.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Galactic\+Binary.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Galactic\+Binary\+I\+O.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Galactic\+Binary\+Prior.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Galactic\+Binary\+Model.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Galactic\+Binary\+Waveform.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Galactic\+Binary\+F\+Statistic.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Galactic\+Binary\+Proposal.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Galactic\+Binary\+Math.\+h\char`\"{}}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_a783c49c38c9489b1a10bc04049b3682f}\label{_galactic_binary_proposal_8c_a783c49c38c9489b1a10bc04049b3682f}} 
\#define {\bfseries F\+I\+X\+ME}~0
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_a8285f8ddc6c3f822f1d4f514bceaa271}\label{_galactic_binary_proposal_8c_a8285f8ddc6c3f822f1d4f514bceaa271}} 
\#define {\bfseries S\+N\+R\+C\+AP}~10000.\+0 /$\ast$ S\+NR cap on logL $\ast$/
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_a2662e53920bbe4d94dc1b22e25f3a52b}\label{_galactic_binary_proposal_8c_a2662e53920bbe4d94dc1b22e25f3a52b}} 
void {\bfseries setup\+\_\+frequency\+\_\+proposal} (struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_ae8c2b734b1d1527285455a36236470c8}\label{_galactic_binary_proposal_8c_ae8c2b734b1d1527285455a36236470c8}} 
void {\bfseries print\+\_\+acceptance\+\_\+rates} (struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$$\ast$proposal, int NP, int ic, F\+I\+LE $\ast$fptr)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_a882af8d84df4b4a0f7d93b5585fe82ab}\label{_galactic_binary_proposal_8c_a882af8d84df4b4a0f7d93b5585fe82ab}} 
double {\bfseries draw\+\_\+from\+\_\+spectrum} (struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, struct \mbox{\hyperlink{struct_model}{Model}} $\ast$model, struct \mbox{\hyperlink{struct_source}{Source}} $\ast$source, U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$proposal, double $\ast$params, gsl\+\_\+rng $\ast$seed)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_aee377606b9a0e7d7cef3caec3df50556}\label{_galactic_binary_proposal_8c_aee377606b9a0e7d7cef3caec3df50556}} 
double {\bfseries draw\+\_\+from\+\_\+prior} (U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, struct \mbox{\hyperlink{struct_model}{Model}} $\ast$model, U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_source}{Source}} $\ast$source, U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$proposal, double $\ast$params, gsl\+\_\+rng $\ast$seed)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_a8666b4978bb48b9083cf8cb1a335877f}\label{_galactic_binary_proposal_8c_a8666b4978bb48b9083cf8cb1a335877f}} 
double {\bfseries draw\+\_\+from\+\_\+extrinsic\+\_\+prior} (U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, struct \mbox{\hyperlink{struct_model}{Model}} $\ast$model, U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_source}{Source}} $\ast$source, U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$proposal, double $\ast$params, gsl\+\_\+rng $\ast$seed)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_a42e3e5ae65a52afab2bcec1dd1b365fd}\label{_galactic_binary_proposal_8c_a42e3e5ae65a52afab2bcec1dd1b365fd}} 
double {\bfseries draw\+\_\+from\+\_\+galaxy\+\_\+prior} (struct \mbox{\hyperlink{struct_model}{Model}} $\ast$model, struct \mbox{\hyperlink{struct_prior}{Prior}} $\ast$prior, double $\ast$params, gsl\+\_\+rng $\ast$seed)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_a970124673a0953fd0ead32795be431ef}\label{_galactic_binary_proposal_8c_a970124673a0953fd0ead32795be431ef}} 
double {\bfseries draw\+\_\+calibration\+\_\+parameters} (struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, struct \mbox{\hyperlink{struct_model}{Model}} $\ast$model, gsl\+\_\+rng $\ast$seed)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_ab00e578ab3662a8afa2baf2cba5ed4fb}\label{_galactic_binary_proposal_8c_ab00e578ab3662a8afa2baf2cba5ed4fb}} 
double {\bfseries draw\+\_\+signal\+\_\+amplitude} (struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, struct \mbox{\hyperlink{struct_model}{Model}} $\ast$model, U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_source}{Source}} $\ast$source, U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$proposal, double $\ast$params, gsl\+\_\+rng $\ast$seed)
\item 
double \mbox{\hyperlink{_galactic_binary_proposal_8c_aee8b56e9a5d83bf195e3c79578457268}{draw\+\_\+from\+\_\+fisher}} (U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, struct \mbox{\hyperlink{struct_model}{Model}} $\ast$model, struct \mbox{\hyperlink{struct_source}{Source}} $\ast$source, U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$proposal, double $\ast$params, gsl\+\_\+rng $\ast$seed)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_a8ac7b844a4a59395d7623f857a96f065}\label{_galactic_binary_proposal_8c_a8ac7b844a4a59395d7623f857a96f065}} 
double {\bfseries draw\+\_\+from\+\_\+cdf} (U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, struct \mbox{\hyperlink{struct_model}{Model}} $\ast$model, struct \mbox{\hyperlink{struct_source}{Source}} $\ast$source, struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$proposal, double $\ast$params, gsl\+\_\+rng $\ast$seed)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_aec1b0f512c7a5f18545a1147b0fbfc4a}\label{_galactic_binary_proposal_8c_aec1b0f512c7a5f18545a1147b0fbfc4a}} 
double {\bfseries cdf\+\_\+density} (U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, struct \mbox{\hyperlink{struct_model}{Model}} $\ast$model, struct \mbox{\hyperlink{struct_source}{Source}} $\ast$source, struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$proposal, double $\ast$params)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_a0fdd7a5e44fd29128ee7beaa335a572f}\label{_galactic_binary_proposal_8c_a0fdd7a5e44fd29128ee7beaa335a572f}} 
double {\bfseries draw\+\_\+from\+\_\+cov} (U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, struct \mbox{\hyperlink{struct_model}{Model}} $\ast$model, struct \mbox{\hyperlink{struct_source}{Source}} $\ast$source, struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$proposal, double $\ast$params, gsl\+\_\+rng $\ast$seed)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_a48c97df4de6815daf57b7f054092a035}\label{_galactic_binary_proposal_8c_a48c97df4de6815daf57b7f054092a035}} 
double {\bfseries cov\+\_\+density} (U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, struct \mbox{\hyperlink{struct_model}{Model}} $\ast$model, struct \mbox{\hyperlink{struct_source}{Source}} $\ast$source, struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$proposal, double $\ast$params)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_aff3c7d1f3059dfdb7723e1d08f40deff}\label{_galactic_binary_proposal_8c_aff3c7d1f3059dfdb7723e1d08f40deff}} 
double {\bfseries fm\+\_\+shift} (struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, struct \mbox{\hyperlink{struct_model}{Model}} $\ast$model, struct \mbox{\hyperlink{struct_source}{Source}} $\ast$source, struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$proposal, double $\ast$params, gsl\+\_\+rng $\ast$seed)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_a6a462b2ade2ace48eb864880bc7e33f3}\label{_galactic_binary_proposal_8c_a6a462b2ade2ace48eb864880bc7e33f3}} 
double {\bfseries psi\+\_\+phi\+\_\+jump} (U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_model}{Model}} $\ast$model, struct \mbox{\hyperlink{struct_source}{Source}} $\ast$source, U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$proposal, double $\ast$params, gsl\+\_\+rng $\ast$seed)
\item 
double \mbox{\hyperlink{_galactic_binary_proposal_8c_a99ccaa6a68983e3f6c1dbd27e8f1c78a}{t0\+\_\+shift}} (U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, struct \mbox{\hyperlink{struct_model}{Model}} $\ast$model, U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_source}{Source}} $\ast$source, U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$proposal, U\+N\+U\+S\+ED double $\ast$params, gsl\+\_\+rng $\ast$seed)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_a56be2a79ceec1bd3e5ca7813ddd10007}\label{_galactic_binary_proposal_8c_a56be2a79ceec1bd3e5ca7813ddd10007}} 
void {\bfseries initialize\+\_\+proposal} (struct \mbox{\hyperlink{struct_orbit}{Orbit}} $\ast$orbit, struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, struct \mbox{\hyperlink{struct_prior}{Prior}} $\ast$prior, struct \mbox{\hyperlink{struct_chain}{Chain}} $\ast$chain, struct \mbox{\hyperlink{struct_flags}{Flags}} $\ast$flags, struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$$\ast$proposal, int N\+M\+AX)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_a970c096c5428c06d08846a24c1e1c3d6}\label{_galactic_binary_proposal_8c_a970c096c5428c06d08846a24c1e1c3d6}} 
void {\bfseries setup\+\_\+fstatistic\+\_\+proposal} (struct \mbox{\hyperlink{struct_orbit}{Orbit}} $\ast$orbit, struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, struct \mbox{\hyperlink{struct_flags}{Flags}} $\ast$flags, struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$proposal)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_af4d23d535092cc291b8c817e72177ecc}\label{_galactic_binary_proposal_8c_af4d23d535092cc291b8c817e72177ecc}} 
void {\bfseries setup\+\_\+prior\+\_\+proposal} (struct \mbox{\hyperlink{struct_flags}{Flags}} $\ast$flags, struct \mbox{\hyperlink{struct_prior}{Prior}} $\ast$prior, struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$proposal)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_a840df697159100dca6ef37caf4bf1db2}\label{_galactic_binary_proposal_8c_a840df697159100dca6ef37caf4bf1db2}} 
void {\bfseries setup\+\_\+cdf\+\_\+proposal} (struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, struct \mbox{\hyperlink{struct_flags}{Flags}} $\ast$flags, struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$proposal, int N\+M\+AX)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_a2eb3f28b6ca7783cd317fc3798793dfd}\label{_galactic_binary_proposal_8c_a2eb3f28b6ca7783cd317fc3798793dfd}} 
void {\bfseries test\+\_\+covariance\+\_\+proposal} (struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, struct \mbox{\hyperlink{struct_flags}{Flags}} $\ast$flags, struct \mbox{\hyperlink{struct_model}{Model}} $\ast$model, struct \mbox{\hyperlink{struct_prior}{Prior}} $\ast$prior, struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$proposal, gsl\+\_\+rng $\ast$seed)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_a7fa3b80b4bd6b1fb7fbf5ac35a28a2eb}\label{_galactic_binary_proposal_8c_a7fa3b80b4bd6b1fb7fbf5ac35a28a2eb}} 
void {\bfseries setup\+\_\+covariance\+\_\+proposal} (struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, struct \mbox{\hyperlink{struct_flags}{Flags}} $\ast$flags, struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$proposal)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_aafb096baebfddf86f0e38100ddc176a3}\label{_galactic_binary_proposal_8c_aafb096baebfddf86f0e38100ddc176a3}} 
double {\bfseries draw\+\_\+from\+\_\+fstatistic} (struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_model}{Model}} $\ast$model, U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_source}{Source}} $\ast$source, struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$proposal, double $\ast$params, gsl\+\_\+rng $\ast$seed)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_afd202d0b69e6c8d622ec85a1b18fdd6e}\label{_galactic_binary_proposal_8c_afd202d0b69e6c8d622ec85a1b18fdd6e}} 
double {\bfseries jump\+\_\+from\+\_\+fstatistic} (struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, struct \mbox{\hyperlink{struct_model}{Model}} $\ast$model, struct \mbox{\hyperlink{struct_source}{Source}} $\ast$source, struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$proposal, double $\ast$params, gsl\+\_\+rng $\ast$seed)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_aaaea7bf91a5ca99c7c29d1d6b7a8de12}\label{_galactic_binary_proposal_8c_aaaea7bf91a5ca99c7c29d1d6b7a8de12}} 
double {\bfseries evaluate\+\_\+fstatistic\+\_\+proposal} (struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_model}{Model}} $\ast$model, U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_source}{Source}} $\ast$source, struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$proposal, double $\ast$params)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_ad42abc9fc4e637728c2206bc88601c3b}\label{_galactic_binary_proposal_8c_ad42abc9fc4e637728c2206bc88601c3b}} 
double {\bfseries prior\+\_\+density} (struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, struct \mbox{\hyperlink{struct_model}{Model}} $\ast$model, U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_source}{Source}} $\ast$source, struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$proposal, double $\ast$params)
\item 
\mbox{\Hypertarget{_galactic_binary_proposal_8c_a6411d0cd1ce0b0862365fa63ee9cd28f}\label{_galactic_binary_proposal_8c_a6411d0cd1ce0b0862365fa63ee9cd28f}} 
double {\bfseries symmetric\+\_\+density} (U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_data}{Data}} $\ast$data, U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_model}{Model}} $\ast$model, U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_source}{Source}} $\ast$source, U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$proposal, U\+N\+U\+S\+ED double $\ast$params)
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{_galactic_binary_proposal_8c_aee8b56e9a5d83bf195e3c79578457268}\label{_galactic_binary_proposal_8c_aee8b56e9a5d83bf195e3c79578457268}} 
\index{GalacticBinaryProposal.c@{GalacticBinaryProposal.c}!draw\_from\_fisher@{draw\_from\_fisher}}
\index{draw\_from\_fisher@{draw\_from\_fisher}!GalacticBinaryProposal.c@{GalacticBinaryProposal.c}}
\doxysubsubsection{\texorpdfstring{draw\_from\_fisher()}{draw\_from\_fisher()}}
{\footnotesize\ttfamily double draw\+\_\+from\+\_\+fisher (\begin{DoxyParamCaption}\item[{U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_data}{Data}} $\ast$}]{data,  }\item[{struct \mbox{\hyperlink{struct_model}{Model}} $\ast$}]{model,  }\item[{struct \mbox{\hyperlink{struct_source}{Source}} $\ast$}]{source,  }\item[{U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$}]{proposal,  }\item[{double $\ast$}]{params,  }\item[{gsl\+\_\+rng $\ast$}]{seed }\end{DoxyParamCaption})}

Use precomputed fisher matrix and center it at current parameters. Choose one eigenvector at random and propose a Gaussian jump along that direction scaled by the associated eigenvalue.

Jumps are conditioned against singular values, in which case the jump along that parameter direction is 0.\+01 the current value.

\mbox{\hyperlink{struct_proposal}{Proposal}} is assumed symmetric because the Fisher matrix is not being updated at each location.

The Fisher is updated periodically during the M\+C\+MC.\mbox{\Hypertarget{_galactic_binary_proposal_8c_a99ccaa6a68983e3f6c1dbd27e8f1c78a}\label{_galactic_binary_proposal_8c_a99ccaa6a68983e3f6c1dbd27e8f1c78a}} 
\index{GalacticBinaryProposal.c@{GalacticBinaryProposal.c}!t0\_shift@{t0\_shift}}
\index{t0\_shift@{t0\_shift}!GalacticBinaryProposal.c@{GalacticBinaryProposal.c}}
\doxysubsubsection{\texorpdfstring{t0\_shift()}{t0\_shift()}}
{\footnotesize\ttfamily double t0\+\_\+shift (\begin{DoxyParamCaption}\item[{U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_data}{Data}} $\ast$}]{data,  }\item[{struct \mbox{\hyperlink{struct_model}{Model}} $\ast$}]{model,  }\item[{U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_source}{Source}} $\ast$}]{source,  }\item[{U\+N\+U\+S\+ED struct \mbox{\hyperlink{struct_proposal}{Proposal}} $\ast$}]{proposal,  }\item[{U\+N\+U\+S\+ED double $\ast$}]{params,  }\item[{gsl\+\_\+rng $\ast$}]{seed }\end{DoxyParamCaption})}

shift start time of data segment 